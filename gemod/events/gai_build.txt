namespace = gai_build

#Build monuments/temples because the AI wont build them in sectors
event = {
	id = gai_build.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_country = {
			limit = {
				NOT = { has_global_flag = disable_gai_build }
				OR = {
					AND = {
						is_ai = yes
						minerals > 450
						has_monthly_income = {
							resource = minerals
							value > 50
						}
					}
					AND = {
						is_ai = yes
						has_monthly_income = {
							resource = minerals
							value < 50
						}
					}
				}
				#is_at_war = no
				is_country_type = "default"
			}
			country_event = { id = gai_build.2 }
		}
	}
}

country_event = {
	id = gai_build.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_owned_planet = {
			limit = {
				is_colony = yes
				is_under_colonization = no
				#NOT = { is_planet_class = pc_habitat }
				solar_system = {
					is_within_borders_of = root
				}
				has_building_construction = no
				any_tile = {
					OR = {
						AND = {
							has_building = no
						}
						AND = {
							has_building = building_mining_network_1
							owner = {
								has_technology = tech_mining_network_2
							}
							
						}
						AND = {
							has_building = building_power_plant_1
							owner = {
								has_technology = tech_power_plant_2
							}
						}
						AND = {
							has_building = building_mining_network_2
							owner = {
								has_technology = tech_mining_network_3
							}
							
						}
						AND = {
							has_building = building_power_plant_2
							owner = {
								has_technology = tech_power_plant_3
							}
						}
						AND = {
							has_building = building_mining_network_3
							owner = {
								has_technology = tech_mining_network_4
							}
							
						}
						AND = {
							has_building = building_power_plant_3
							owner = {
								has_technology = tech_power_plant_4
							}
						}
					}
					has_blocker = no 
				}
			}
			
			if = {
				limit = {
					has_growing_pop = no
					free_pop_tiles > 0
					owner = { 
						minerals > 100 
						has_authority = auth_machine_intelligence
					}
				}
				build_pop = {
					name = buildable_robot_pop_4
					grown = no
				}
				owner = { add_minerals = -100 }
			}

			random_tile = {
				limit = {
					has_resource = {
						type = sr_alien_pets
						amount > 0
					}
					has_blocker = no
					OR = {
						has_grown_pop = yes
						has_growing_pop = yes
					}
					NOT = { has_building = building_xeno_zoo }
				}
				IF = {
					limit = {
						owner = { minerals > 150 }
						NOT = { has_building = building_xeno_zoo }
						owner = { has_technology = tech_alien_life_studies }
						NOT = { owner = { has_authority = auth_machine_intelligence } }
					}
					add_building_construction = building_xeno_zoo
				}
				IF = {
					limit = {
						owner = { minerals > 60 }
						has_building = no
						NOT = { owner = { has_technology = tech_alien_life_studies } }
					}
					add_building_construction = building_basic_science_lab_1
				}
				IF = {
					limit = {
						owner = { minerals > 150 }
						NOT = { has_building = building_animal_evaluation_laboratory }
						owner = { has_technology = tech_alien_life_studies }
						owner = { has_authority = auth_machine_intelligence }
					}
					add_building_construction = building_animal_evaluation_laboratory
					
				}
			}

			random_tile = {
				limit = {
					has_resource = {
						type = sr_betharian
						amount > 0
					}
					has_blocker = no
					NOT = { has_building = betharian_power_plant }
				}
				IF = {
					limit = {
						NOT = { has_building = betharian_power_plant }
						has_blocker = no
						owner = { has_technology = tech_mine_betharian }
						owner = { minerals > 150 }
					}
					add_building_construction = betharian_power_plant
					
				}
			}
			
			random_tile = {
				limit = {
					has_blocker = no
					gai_is_blank = yes
					NOT = { gai_near_capital = yes }
					owner = {
						OR = {
							has_monthly_income = {
								resource = food
								value > 30
							}
							has_authority = auth_machine_intelligence
						}
						has_monthly_income = {
							resource = energy
							value > 75
						}
						has_monthly_income = {
							resource = minerals
							value > 75
						}
						owner = { minerals > 300 }
					}
					OR = {
						has_building = building_power_plant_1
						has_building = building_power_plant_2
						has_building = building_power_plant_3
						has_building = building_power_plant_4
						has_building = building_power_plant_5
						has_building = building_military_academy
						has_building = building_visitor_center
						has_building = building_biolab_1
						has_building = building_biolab_2
						has_building = building_biolab_3
						has_building = building_physics_lab_1
						has_building = building_physics_lab_2
						has_building = building_physics_lab_3
						has_building = building_engineering_facility_1
						has_building = building_engineering_facility_2
						has_building = building_engineering_facility_3
						has_building = building_basic_science_lab_1
						has_building = no
					}
				}
				IF = {
					limit = {
						planet = {
							count_tile = {
								limit = {
									OR = {
										has_building = building_stronghold
										has_building = building_fortress
									}
								}
								count < 3
							}
						}
					}
					add_building_construction = building_stronghold
				}
			}
			
			random_tile = {
				limit = {
					has_blocker = no
					OR = {
						gai_has_physics = yes
						gai_has_engineering = yes
					}
					owner = {
						minerals > 500
						has_technology = tech_planetary_shield_generator
					}
					OR = {
						has_building = building_physics_lab_1
						has_building = building_physics_lab_2
						has_building = building_physics_lab_3
						has_building = building_engineering_facility_1
						has_building = building_engineering_facility_2
						has_building = building_engineering_facility_3
						has_building = building_basic_science_lab_1
						has_building = no
					}
				}
				IF = {
					limit = {
						NOT = { planet = { has_building = building_planetary_shield_generator } }
					}
					add_building_construction = building_planetary_shield_generator
				}
			}
			###############normal buildings below################
			random_tile = {
				limit = {
					has_blocker = no
					OR = {
						has_building = no
						AND = {
							gai_is_blank = yes
							has_building = no
							gai_near_capital = yes
						}
						AND = {
							owner = {
								has_monthly_income = {
									resource = food
									value > 120
								}
								has_monthly_income = {
									resource = energy
									value < 50
								}
							}
							OR = {
								has_building = building_hydroponics_farm_1
								has_building = building_hydroponics_farm_2
								has_building = building_hydroponics_farm_3
								has_building = building_hydroponics_farm_4
								has_building = building_hydroponics_farm_5
							}
						}
					}
					has_blocker = no
					gai_energy_okay = yes
				}
				IF = {
					limit = {
						owner = { minerals > 60 }
						NOT = {
							planet = {
								any_tile = {
									has_building = building_power_plant_1
									has_grown_pop = no
								}
							}
						}
					}
					add_building_construction = building_power_plant_1
				}
			}
			random_tile = {
				limit = {
					OR = {
						has_building = no
						AND = {
							owner = {
								has_monthly_income = {
									resource = food
									value > 120
								}
								has_monthly_income = {
									resource = energy
									value > 50
								}
							}
							OR = {
								has_building = building_hydroponics_farm_1
								has_building = building_hydroponics_farm_2
								has_building = building_hydroponics_farm_3
								has_building = building_hydroponics_farm_4
								has_building = building_hydroponics_farm_5
							}
						}
					}
					has_blocker = no
					gai_mine_okay = yes
				}
				IF = {
					limit = {
						owner = { minerals > 60 }
						NOT = {
							planet = {
								any_tile = {
									has_building = building_mining_network_1
									has_grown_pop = no
								}
							}
						}
					}
					add_building_construction = building_mining_network_1
				}
			}
			random_tile = {
				limit = {
					has_building = no
					has_blocker = no
					planet = { has_building_construction = no }
					gai_farm_okay = yes
					OR = {
						has_grown_pop = yes
						has_growing_pop = yes
					}
				}
				IF = {
					limit = {
						owner = {
							minerals > 60
							NOT = { has_valid_civic = civic_machine_servitor }							
						}
					}
					add_building_construction = building_hydroponics_farm_1
				}
			}
			random_tile = {
				limit = {
					has_building = no
					has_blocker = no
					OR = { 
						gai_research_okay = yes
						AND = {
							has_building = no
							gai_near_capital = no
							AND = { 
								gai_is_blank = yes
								OWNER = { 
									has_monthly_income = {
										resource = energy
										value > 40
									}
									has_monthly_income = {
										resource = minerals
										value > 40
									}
								}
							}
						}
					}
					OR = {
						has_grown_pop = yes
						has_growing_pop = yes
					}
				}
				IF = {
					limit = {
						planet = { has_building_construction = no }
						owner = { minerals > 60 }
					}
					add_building_construction = building_basic_science_lab_1
					
				}
			}
			#########Tier 2#########
			random_tile = {
				limit = {
					has_building = building_power_plant_1
				}
				IF = {
					limit = {
						planet = { gai_upgraded_capital = yes }
					}
					add_building_construction = building_power_plant_2
				}
			}
			random_tile = {
				limit = {
					has_building = building_mining_network_1
				}
				IF = {
					limit = {
						planet = { gai_upgraded_capital = yes }
					}
					add_building_construction = building_mining_network_2
				}
			}
			#########Tier 3#########
			random_tile = {
				limit = {
					has_building = building_power_plant_2
				}
				IF = {
					limit = {
						planet = { gai_upgraded_capital = yes }
					}
					add_building_construction = building_power_plant_3
				}
			}
			random_tile = {
				limit = {
					has_building = building_mining_network_2
				}
				IF = {
					limit = {
						planet = { gai_upgraded_capital = yes }
					}
					add_building_construction = building_mining_network_3
				}
			}
			#########Tier 4#########
			random_tile = {
				limit = {
					has_building = building_power_plant_3
				}
				IF = {
					limit = {
						planet = { gai_upgraded_capital = yes }
					}
					add_building_construction = building_power_plant_4
				}
			}
			random_tile = {
				limit = {
					has_building = building_mining_network_3
				}
				IF = {
					limit = {
						planet = { gai_upgraded_capital = yes }
					}
					add_building_construction = building_mining_network_4
				}
			}
		}
	}
}


#event from dpe_diplo_events
namespace = gai_starvation

#Feed the people.
planet_event = {
	id = gai_starvation.1
	hide_window = yes
	mean_time_to_happen = {
		months = 1
	}

	trigger = {
		has_owner = yes
		exists = owner
		NOT = {
			owner = { has_authority = auth_machine_intelligence }
		}
		owner = {
			and = {
				is_ai = yes
				is_country_type = default
				food < 150
				has_monthly_income = {
					resource = food
					value < 1
				}
			}
		}
		not = {
			is_planet_class = pc_habitat
		}
		NOT = { has_global_flag = disable_gai_starvation }
		has_building_construction = no
		any_tile = {
			OR = {
				gai_is_blank = yes 
				gai_has_food = yes
				gai_has_minerals = yes
				gai_has_energy = yes
			}
		}
	}

	immediate = {
		random_tile = {
			limit = {
				has_blocker = no
				NOT = {
					owner = { has_authority = auth_machine_intelligence }
				}
				AND = {
					OR = {
						AND = {
							gai_is_blank = yes 
							gai_has_sr = no
							NOT = {
								planet = {
									any_tile = {
										gai_has_food = yes
										has_blocker = no
										has_building = no
									}
								}
							}
						}
						AND = {
							gai_has_minerals = yes
							gai_has_sr = no
							NOT = {
								planet = {
									any_tile = {
										gai_is_blank = yes
										has_blocker = no
										has_building = no
									}
								}
							}
							owner = {
								has_monthly_income = {
									resource = minerals
									value > 5
								}
							}
						}
						AND = {
							gai_has_energy = yes
							gai_has_sr = no
							NOT = {
								planet = {
									any_tile = {
										gai_is_blank = yes
										has_blocker = no
										has_building = no
									}
								}
							}
							owner = {
								has_monthly_income = {
									resource = energy
									value > 5
								}
							}
						}
						AND = {
							gai_has_food = yes
							gai_has_sr = no
						}
					}
					gai_food_okay_to_replace = yes
				}
			}
			IF = {
				limit = {owner = {minerals > 60}}
				add_building_construction = building_hydroponics_farm_1
			}
			IF = {
				limit = {owner = {minerals < 60}}
				set_building = building_hydroponics_farm_1
			}
		}
	}
}



#####################################
#####################################
#####                           #####
#####    Scripted Effect        #####
#####                           #####
#####    Transcribe Variable    #####
#####                           #####
#####################################
#####################################


################
###  Common  ###
################

CmtEffectTransferAll = {
	CmtEffectTransferCrisisPower = yes
	CmtEffectTransferKhanPostDeath = yes
}



##############
###  Khan  ###
##############

### Resurgence of Khan (Transcribe when they awakening)
CmtEffectTransferKhanRemainingLive = {		### Scope: root = Awakened Khan Country
	event_target:CmtGlobalVar = {
		if = {
			limit = { check_variable = { which = CmtVarKhanResurgence value < -0.5 } }
			root = { set_variable = { which = CmtVarKhanRemainingLive value = -1 } }
		} else = {
			set_variable = { which = CmtVarTemp value = CmtVarKhanResurgence }
			root = { set_variable = { which = CmtVarKhanRemainingLive value = 0 } }
			while = {
				limit = { check_variable = { which = CmtVarTemp value > 0.5 } }
				change_variable = { which = CmtVarTemp value = -1 }
				root = { change_variable = { which = CmtVarKhanRemainingLive value = 1 } }
			}
			set_variable = { which = CmtVarTemp value = 0 }
		}
	}
}

### Future of Horde
CmtEffectTransferKhanPostDeath = {
	event_target:CmtGlobalVar = {
		if = {
			limit = { check_variable = { which = CmtVarKhanPostDeathSummary value = 2 } }
			set_variable = { which = CmtVarKhanPostDeathDemocratic value = 3 }
			set_variable = { which = CmtVarKhanPostDeathSplinter value = 1 }
			set_variable = { which = CmtVarKhanPostDeathKhanate value = 1 }
		} else_if = {
			limit = { check_variable = { which = CmtVarKhanPostDeathSummary value = 3 } }
			set_variable = { which = CmtVarKhanPostDeathDemocratic value = 3 }
			set_variable = { which = CmtVarKhanPostDeathSplinter value = 1 }
			set_variable = { which = CmtVarKhanPostDeathKhanate value = 3 }
		} else_if = {
			limit = { check_variable = { which = CmtVarKhanPostDeathSummary value = 4 } }
			set_variable = { which = CmtVarKhanPostDeathDemocratic value = 0 }
			set_variable = { which = CmtVarKhanPostDeathSplinter value = 0 }
			set_variable = { which = CmtVarKhanPostDeathKhanate value = 3 }
		} else_if = {
			limit = { check_variable = { which = CmtVarKhanPostDeathSummary value = 5 } }
			set_variable = { which = CmtVarKhanPostDeathDemocratic value = 0 }
			set_variable = { which = CmtVarKhanPostDeathSplinter value = 4 }
			set_variable = { which = CmtVarKhanPostDeathKhanate value = 1 }
		} else_if = {
			limit = { check_variable = { which = CmtVarKhanPostDeathSummary value = 6 } }
			set_variable = { which = CmtVarKhanPostDeathDemocratic value = 0 }
			set_variable = { which = CmtVarKhanPostDeathSplinter value = 3 }
			set_variable = { which = CmtVarKhanPostDeathKhanate value = 0 }
		} else = {
			set_variable = { which = CmtVarKhanPostDeathDemocratic value = 2 }
			set_variable = { which = CmtVarKhanPostDeathSplinter value = 4 }
			set_variable = { which = CmtVarKhanPostDeathKhanate value = 2 }
		}
	}
}




######################
###  Crisis Power  ###
######################

CmtEffectTransferCrisisPower = {
	event_target:CmtGlobalVar = {
		set_variable = { which = CmtVarColonizerNumber_Prethoryn value = CmtVarConstructorNumber_Prethoryn }
		if = {
			limit = { check_variable = { which = CmtVarColonizerNumber_Prethoryn value > 1.375 } }
			change_variable = { which = CmtVarColonizerNumber_Prethoryn value = -1 }
			multiply_variable = { which = CmtVarColonizerNumber_Prethoryn value = 0.5 }
			change_variable = { which = CmtVarColonizerNumber_Prethoryn value = 1 }
		}
		### y = 1 + (x - 1) / 2		if x >= 1.5
	}
}



